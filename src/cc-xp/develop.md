---
description: XP develop â€“ TDD+E2Eã‚µã‚¤ã‚¯ãƒ«ï¼ˆRedâ†’Greenâ†’Refactorâ†’E2Eï¼‰ã‚’å®Œèµ°
argument-hint: '[id] â€»çœç•¥æ™‚ã¯ in-progress ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ä½¿ç”¨'
allowed-tools: Bash(git:*), Bash(date), Bash(test), Bash(bun:*), Bash(npm:*), Bash(pnpm:*), Bash(uv:*), Bash(python:*), Bash(pytest:*), Bash(cargo:*), Bash(go:*), Bash(bundle:*), Bash(dotnet:*), Bash(gradle:*), Bash(npx:*), Bash(ls), WriteFile, ReadFile, mcp__playwright__*
---

## ã‚´ãƒ¼ãƒ«

**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**ã§ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿè£…ã—ã€å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç´ æ—©ãä½œã‚‹ã€‚Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆã¯E2Eãƒ†ã‚¹ãƒˆã¾ã§å«ã‚ãŸå®Œå…¨ãªå“è³ªä¿è¨¼ã‚’å®Ÿç¾ã™ã‚‹ã€‚å„ãƒ•ã‚§ãƒ¼ã‚ºã‚’Gitã§è¨˜éŒ²ã€‚

## XP/TDD+E2EåŸå‰‡

- **Red**: ã¾ãšå¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
- **Green**: ãƒ†ã‚¹ãƒˆã‚’é€šã™æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰
- **Refactor**: å‹•ä½œã‚’ä¿ã¡ãªãŒã‚‰æ”¹å–„
- **E2E**: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦–ç‚¹ã§ã®çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆWebã‚¢ãƒ—ãƒªã®å ´åˆï¼‰
- **å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—**: ä¸€åº¦ã«ä¸€ã¤ã®ã“ã¨ã ã‘
- **ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: å„ãƒ•ã‚§ãƒ¼ã‚ºã‚’ã‚³ãƒŸãƒƒãƒˆ

## ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª

### ä»®èª¬é§†å‹•ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æƒ…å ±ã®å–å¾—

**é‡è¦**: é–‹ç™ºé–‹å§‹å‰ã«ã€ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ä»®èª¬ãƒ»KPIãƒ»æˆ¦ç•¥æƒ…å ±ã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚

#### åŸºæœ¬æƒ…å ±ã®å–å¾—
- in-progressã‚¹ãƒˆãƒ¼ãƒªãƒ¼: @docs/cc-xp/backlog.yaml ã‹ã‚‰ç¢ºèª
- è©³ç´°ã‚¹ãƒˆãƒ¼ãƒªãƒ¼: @docs/cc-xp/stories/[ID].md
- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰: @docs/cc-xp/stories/[ID]-feedback.md
- ç¾åœ¨ã®ãƒ–ãƒ©ãƒ³ãƒ: !git branch --show-current
- GitçŠ¶æ…‹: !git status --short
- ç¾åœ¨æ™‚åˆ»: !date +"%Y-%m-%dT%H:%M:%S%:z"

$ARGUMENTS ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®IDã€ãªã‘ã‚Œã° `in-progress` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

#### ä»®èª¬é§†å‹•é–‹ç™ºæƒ…å ±ã®ç¢ºèª

**backlog.yaml ã‹ã‚‰å–å¾—ã™ã¹ãæˆ¦ç•¥æƒ…å ±**:
- **hypothesis**: æ¤œè¨¼ã™ã¹ãæ ¸å¿ƒä»®èª¬
- **kpi_target**: å…·ä½“çš„æˆåŠŸæŒ‡æ¨™
- **success_metrics**: KPIæ¸¬å®šæ–¹æ³•
- **business_value**, **user_value**: ä¾¡å€¤ã‚¹ã‚³ã‚¢
- **user_persona**: å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **competition_analysis**: ç«¶åˆå·®åˆ¥åŒ–è¦å› 

**ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«(@docs/cc-xp/stories/[ID].md)ã‹ã‚‰å–å¾—**:
- ä»®èª¬æ¤œè¨¼é‡è¦–ã®å—ã‘å…¥ã‚Œæ¡ä»¶
- KPIæ¸¬å®šå¯èƒ½ãªãƒ†ã‚¹ãƒˆè¦ä»¶
- ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤å®Ÿç¾ã®ãƒ’ãƒ³ãƒˆ

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**ï¼š
- å¯¾è±¡ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãŒ `in-progress` ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- `done` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã¯é–‹ç™ºå¯¾è±¡å¤–

**ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ« vs åˆå›é–‹ç™º**ï¼š
- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ â†’ ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«ï¼ˆå‰å›å•é¡Œã®è§£æ±ºé‡è¦–ï¼‰
- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ãªã— â†’ åˆå›é–‹ç™ºï¼ˆä»®èª¬æ¤œè¨¼é‡è¦–ï¼‰

**é‡è¦**: ä¸Šè¨˜æˆ¦ç•¥æƒ…å ±ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯æ—§å½¢å¼ã¨ã—ã¦æ‰±ã„ã€åŸºæœ¬TDDã®ã¿å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

## é–‹ç™ºç’°å¢ƒã®æ¤œå‡º

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰é©åˆ‡ãªãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã‚’åˆ¤å®šã—ã¦ãã ã•ã„ï¼š

### æ¤œå‡ºå¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
- JavaScript/TypeScript: 
  - package.jsonç¢ºèª: !test -f package.json
  - Bunç¢ºèª: !test -f bun.lockb
  - pnpmç¢ºèª: !test -f pnpm-lock.yaml
- Python: 
  - pyproject.tomlç¢ºèª: !test -f pyproject.toml
  - requirements.txtç¢ºèª: !test -f requirements.txt
- Rust: !test -f Cargo.toml
- Go: !test -f go.mod
- Ruby: !test -f Gemfile
- Java: !test -f build.gradle
- C#: !ls *.csproj

### æ¨å¥¨ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰
æ¤œå‡ºã•ã‚ŒãŸè¨€èªã«å¿œã˜ã¦ä»¥ä¸‹ã‚’ä½¿ç”¨ï¼š
- JavaScript/TypeScript: `bun test` ã¾ãŸã¯ `npm test`
- Python: `uv run pytest` ã¾ãŸã¯ `python -m pytest`
- Rust: `cargo test`
- Go: `go test ./...`
- Ruby: `bundle exec rspec`
- Java: `./gradlew test`
- C#: `dotnet test`

### E2Eãƒ†ã‚¹ãƒˆç’°å¢ƒã®åˆ¤å®š

**Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¤œå‡º**ï¼š
ä»¥ä¸‹ã®æ¡ä»¶ã§Webã‚¢ãƒ—ãƒªã¨åˆ¤å®šã—ã€E2Eãƒ†ã‚¹ãƒˆãƒ•ã‚§ãƒ¼ã‚ºã‚’è¿½åŠ ï¼š
- package.jsonã«`"dev"`ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚‹
- index.htmlã€app.jsã€main.tsãªã©ã®Webãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆReactã€Vueã€Angularã€Svelteç­‰ï¼‰ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

**E2Eãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®é¸æŠ**ï¼š
1. **MCP Playwrightå„ªå…ˆ**: åˆ©ç”¨å¯èƒ½ãªå ´åˆã¯è‡ªå‹•å®Ÿè¡Œ
2. **é€šå¸¸Playwright**: playwright.config.*ãŒå­˜åœ¨ã™ã‚‹å ´åˆ
3. **æ‰‹å‹•E2Eãƒ†ã‚¹ãƒˆ**: Playwrightæœªå¯¾å¿œç’°å¢ƒã§ã¯æ‰‹å‹•ç¢ºèªã‚’æ¨å¥¨

## ä»®èª¬é§†å‹•TDDã‚µã‚¤ã‚¯ãƒ«ã®å®Ÿæ–½

### é–‹ç™ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®é¸æŠ

**åˆå›é–‹ç™ºï¼ˆãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ãªã—ï¼‰**:
1. **ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆã‹ã‚‰é–‹å§‹** - KPIæ¸¬å®šå¯èƒ½ãªãƒ†ã‚¹ãƒˆä½œæˆ
2. æ ¸å¿ƒä¾¡å€¤ã‚’æœ€çŸ­ã§æ¤œè¨¼ã™ã‚‹å®Ÿè£…
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¨ç«¶åˆå„ªä½æ€§ã‚’ç¢ºä¿

**ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«ï¼ˆãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ï¼‰**:
1. **å‰å›ã®å•é¡Œã‚’å†ç¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã‹ã‚‰é–‹å§‹**
2. æ—¢å­˜ã®ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆãŒå£Šã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
3. ä¿®æ­£ã¯æœ€å°é™ã«ç•™ã‚ã‚‹ï¼ˆä»–ã®éƒ¨åˆ†ã‚’å£Šã•ãªã„ï¼‰

### Phase 1: Redï¼ˆä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆä½œæˆï¼‰

#### ğŸ¯ ä»®èª¬æ¤œè¨¼ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**æœ€å„ªå…ˆ**: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®`hypothesis`ã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’ä½œæˆ

#### ã‚¿ã‚¹ã‚¯æ‰‹é †
1. **æ ¸å¿ƒä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆ**: backlog.yamlã®`hypothesis`ã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æœ€åˆã«ä½œæˆ
2. **KPIæ¸¬å®šãƒ†ã‚¹ãƒˆ**: `kpi_target`ã«å¯¾å¿œã™ã‚‹æ¸¬å®šãƒ†ã‚¹ãƒˆã‚’çµ„ã¿è¾¼ã¿
3. **å—ã‘å…¥ã‚Œæ¡ä»¶ãƒ†ã‚¹ãƒˆ**: @docs/cc-xp/stories/[ID].md ã®ä»®èª¬æ¤œè¨¼é‡è¦–å—ã‘å…¥ã‚Œæ¡ä»¶ã‚’ãƒ†ã‚¹ãƒˆåŒ–
4. é©åˆ‡ãªãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆtests/, test/, spec/, __tests__/ï¼‰
5. **å¿…ãšå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª**

#### ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ä¾‹

**å¾“æ¥ã®ãƒ†ã‚¹ãƒˆ**ï¼ˆæ©Ÿèƒ½ä¸­å¿ƒï¼‰:
```typescript
describe("ã‚²ãƒ¼ãƒ ç›¤é¢", () => {
  test("10Ã—20ã®ã‚µã‚¤ã‚ºã§ã‚ã‚‹", () => {
    const board = createBoard(); // æŠ€è¡“çš„ãªæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
    expect(board.width).toBe(10);
    expect(board.height).toBe(20);
  });
});
```

**ä»®èª¬é§†å‹•ãƒ†ã‚¹ãƒˆ**ï¼ˆãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ä¸­å¿ƒï¼‰:
```typescript
import { expect, test, describe } from "bun:test";
import { startTimer, measureKPI } from "./kpi-tracker"; // KPIæ¸¬å®šãƒ©ã‚¤ãƒ–ãƒ©ãƒª

describe("æ ¸å¿ƒä»®èª¬: 3ç§’ä»¥å†…ã§ã‚²ãƒ¼ãƒ é–‹å§‹ã§ãã‚‹", () => {
  test("å¿™ã—ã„ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³ãŒå³åº§ã«ãƒ†ãƒˆãƒªã‚¹ã‚’é–‹å§‹", async () => {
    // ä»®èª¬æ¤œè¨¼: åˆå›èµ·å‹•ã‹ã‚‰3ç§’ä»¥å†…ã§ã‚²ãƒ¼ãƒ é–‹å§‹
    const startTime = startTimer();
    const game = await createQuickStartTetris(); // ã¾ã å­˜åœ¨ã—ãªã„
    const loadTime = startTime.elapsed();
    
    // KPIæ¤œè¨¼: 3ç§’ä»¥å†…ã®èµ·å‹•
    expect(loadTime).toBeLessThan(3000);
    
    // ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤æ¤œè¨¼: ã‚²ãƒ¼ãƒ ãŒã™ãã«ãƒ—ãƒ¬ã‚¤å¯èƒ½
    expect(game.isPlayable()).toBe(true);
    expect(game.canDropPiece()).toBe(true);
    
    // KPIæ¸¬å®šãƒ‡ãƒ¼ã‚¿ã®è¨˜éŒ²
    measureKPI('game_startup_time', loadTime);
    measureKPI('user_persona', 'busy_businessperson');
  });
  
  test("ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ãŒ5-10åˆ†ã®ç¯„å›²ã«åã¾ã‚‹è¨­è¨ˆ", () => {
    const game = createQuickStartTetris(); // ã¾ã å­˜åœ¨ã—ãªã„
    
    // ä»®èª¬æ¤œè¨¼: çŸ­æ™‚é–“ã§æ²¡å…¥ã§ãã‚‹ä½“é¨“è¨­è¨ˆ
    expect(game.hasFastPacedGamplay()).toBe(true);
    expect(game.hasNaturalEndpoints()).toBe(true); // è‡ªç„¶ãªçµ‚äº†ãƒã‚¤ãƒ³ãƒˆ
    
    // ç«¶åˆå·®åˆ¥åŒ–: ä»–ã®ãƒ†ãƒˆãƒªã‚¹ã‚ˆã‚Šæ‰‹è»½
    expect(game.hasOneClickStart()).toBe(true);
  });
});
```

**Python (pytest) - ä»®èª¬é§†å‹•ç‰ˆ**
```python
import time
import pytest
from kpi_tracker import measure_kpi, start_timer

class TestCoreHypothesis:
    """æ ¸å¿ƒä»®èª¬: 3ç§’ä»¥å†…ã§ã‚²ãƒ¼ãƒ é–‹å§‹ã§ãã‚‹"""
    
    def test_quick_start_for_busy_businessperson(self):
        """å¿™ã—ã„ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³ãŒå³åº§ã«ãƒ†ãƒˆãƒªã‚¹ã‚’é–‹å§‹"""
        # ä»®èª¬æ¤œè¨¼: åˆå›èµ·å‹•ã‹ã‚‰3ç§’ä»¥å†…
        start_time = start_timer()
        game = create_quick_start_tetris()  # ã¾ã å­˜åœ¨ã—ãªã„
        load_time = start_time.elapsed()
        
        # KPIæ¤œè¨¼
        assert load_time < 3000  # 3ç§’ä»¥å†…
        assert game.is_playable()
        
        # KPIæ¸¬å®šãƒ‡ãƒ¼ã‚¿è¨˜éŒ²
        measure_kpi('game_startup_time', load_time)
        measure_kpi('user_persona', 'busy_businessperson')
```

#### ç¢ºèªã¨ã‚³ãƒŸãƒƒãƒˆ
ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€**å¤±æ•—ã‚’ç¢ºèª**ã—ã¦ã‹ã‚‰ï¼š
```bash
git add [ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«]
git commit -m "test: ğŸ”´ [ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ã‚¤ãƒˆãƒ«]ã®ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ "
```

### Phase 2: Greenï¼ˆä»®èª¬æ¤œè¨¼å®Ÿè£…ï¼‰

#### ğŸ¯ ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤é‡è¦–ã®æœ€å°å®Ÿè£…

**ã‚¿ã‚¹ã‚¯**
1. **ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆã‚’é€šã™å®Ÿè£…**ã‚’æœ€å„ªå…ˆã§ä½œæˆ
2. **KPIæ¸¬å®šæ©Ÿèƒ½**ã‚’çµ„ã¿è¾¼ã‚€ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã‚‚OKï¼‰
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¨ç«¶åˆå„ªä½æ€§ã‚’ç¢ºä¿ã™ã‚‹å®Ÿè£…
4. ãƒ†ã‚¹ãƒˆãŒ**æˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª**

#### å®Ÿè£…ä¾‹ã®æ¯”è¼ƒ

**å¾“æ¥ã®å®Ÿè£…**ï¼ˆæ©Ÿèƒ½ä¸­å¿ƒï¼‰:
```javascript
function createBoard() {
  return { width: 10, height: 20 }; // æŠ€è¡“è¦ä»¶ã ã‘æº€ãŸã™
}
```

**ä»®èª¬é§†å‹•å®Ÿè£…**ï¼ˆãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ä¸­å¿ƒï¼‰:
```javascript
// ä»®èª¬æ¤œè¨¼: 3ç§’ä»¥å†…ã§ã‚²ãƒ¼ãƒ é–‹å§‹å¯èƒ½ãªå®Ÿè£…
async function createQuickStartTetris() {
  const startTime = performance.now();
  
  // æœ€å°é™ã ãŒã€ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã‚’å®Ÿç¾ã™ã‚‹å®Ÿè£…
  const game = {
    // å³åº§ã«ãƒ—ãƒ¬ã‚¤å¯èƒ½ï¼ˆç«¶åˆå„ªä½æ€§ï¼‰
    isPlayable: () => true,
    canDropPiece: () => true,
    hasOneClickStart: () => true,
    
    // çŸ­æ™‚é–“æ²¡å…¥ä½“é¨“è¨­è¨ˆ
    hasFastPacedGamplay: () => true,
    hasNaturalEndpoints: () => true,
    
    // KPIæ¸¬å®šæ©Ÿèƒ½ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰
    measureStartupTime: () => performance.now() - startTime
  };
  
  // KPIæ¸¬å®šãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²
  const loadTime = performance.now() - startTime;
  console.log(`Startup time: ${loadTime}ms`); // å¾Œã§KPIã‚·ã‚¹ãƒ†ãƒ ã«é€ä¿¡
  
  return game;
}
```

#### ç¢ºèªã¨ã‚³ãƒŸãƒƒãƒˆ
ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€**ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆæˆåŠŸã‚’ç¢ºèª**ã—ã¦ã‹ã‚‰ï¼š
```bash
git add [å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«]
git commit -m "feat: âœ… [ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ã‚¤ãƒˆãƒ«]ã®ä»®èª¬æ¤œè¨¼å®Ÿè£… - [hypothesisè¦ç´„]"
```

### Phase 3: Refactorï¼ˆä¾¡å€¤æœ€é©åŒ–ï¼‰

#### ğŸš€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¾¡å€¤ã¨ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã®æœ€é©åŒ–

**ã‚¿ã‚¹ã‚¯**
1. **KPIæ¸¬å®šç²¾åº¦ã‚’å‘ä¸Š**
2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æ”¹å–„**ï¼ˆuser_personaã«åŸºã¥ãï¼‰
3. **ç«¶åˆå·®åˆ¥åŒ–è¦å› ã‚’å¼·åŒ–**ï¼ˆcompetition_analysisã«åŸºã¥ãï¼‰
4. é‡è¤‡é™¤å»ãƒ»åå‰æ”¹å–„ï¼ˆä½†ã—YAGNIéµå®ˆï¼‰
5. **ä»®èª¬æ¤œè¨¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šç¶šã‘ã‚‹ã“ã¨ã‚’ç¢ºèª**

#### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ä¾‹
```javascript
// KPIæ¸¬å®šã®æ”¹å–„
const KPI_TRACKER = {
  gameStartupTime: [],
  userPersona: new Set(),
  
  record(metric, value) {
    this[metric].push({ value, timestamp: Date.now() });
    // å¾Œã§backlog.yamlã®success_metricsã«åŸºã¥ã„ã¦åˆ†æ
  }
};

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æœ€é©åŒ–ï¼ˆuser_personaã«åŸºã¥ãï¼‰
function optimizeForBusyBusinessperson(game) {
  // 25-35æ­³ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³å‘ã‘ã®ä½“é¨“æ”¹å–„
  return {
    ...game,
    hasQuickTutorial: () => true, // å¿™ã—ã„äººå‘ã‘
    supportsOneHandedPlay: () => true, // é€šå‹¤ä¸­å¯¾å¿œ
    hasProgressSaving: () => true // ä¸­æ–­ãƒ»å†é–‹å¯¾å¿œ
  };
}
```

#### ç¢ºèªã¨ã‚³ãƒŸãƒƒãƒˆ
ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€**ä»®èª¬æ¤œè¨¼ç²¾åº¦å‘ä¸Šã‚’ç¢ºèª**ã—ã¦ã‹ã‚‰ï¼š
```bash
git add -u
git commit -m "refactor: â™»ï¸ [ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ã‚¤ãƒˆãƒ«]ã®ä¾¡å€¤æœ€é©åŒ– - KPIæ¸¬å®šç²¾åº¦å‘ä¸Š"
```

## ä»®èª¬æ¤œè¨¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

### æ‹¡å¼µãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°

@docs/cc-xp/metrics.json ã‚’**ä»®èª¬æ¤œè¨¼çµæœã‚’å«ã‚ã¦**æ›´æ–°ï¼š

#### åŸºæœ¬TDDã‚µã‚¤ã‚¯ãƒ«è¨˜éŒ²
- tddCycles.red += 1
- tddCycles.green += 1  
- tddCycles.refactor += 1
- lastUpdated: ç¾åœ¨æ™‚åˆ»

#### ä»®èª¬é§†å‹•é–‹ç™ºãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆæ–°è¦è¿½åŠ ï¼‰
```json
{
  "hypothesisDriven": {
    "hypothesesTested": 1,
    "kpiMeasurements": {
      "game_startup_time": [2850, 2920, 2780], // å®Ÿæ¸¬å€¤
      "user_engagement": "pending", // å¾Œã§reviewãƒ•ã‚§ãƒ¼ã‚ºã§æ¸¬å®š
      "competitive_advantage": "implemented"
    },
    "businessValueRealized": {
      "user_value_score": 8, // backlog.yamlã‹ã‚‰
      "business_value_score": 7,
      "priority_score": 2.67
    },
    "personas": ["busy_businessperson"],
    "lastHypothesisTest": "ç¾åœ¨æ™‚åˆ»"
  }
}
```

### æˆ¦ç•¥çš„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

@docs/cc-xp/backlog.yaml ã®è©²å½“ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ï¼š
- status: `in-progress` â†’ `testing` ï¼ˆ**é‡è¦**: doneã«ã¯ã—ãªã„ï¼‰
- updated_at: ç¾åœ¨æ™‚åˆ»

#### ä»®èª¬æ¤œè¨¼é€²æ—ã®è¨˜éŒ²ï¼ˆæ–°è¦è¿½åŠ ï¼‰
```yaml
  # æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¿½åŠ 
  hypothesis_status: "implemented" # implemented/pending/failed
  kpi_measurements:
    - metric: "game_startup_time"
      target: "< 3000ms"
      actual: [2850, 2920, 2780]
      status: "passing"
  development_notes: |
    ä»®èª¬ã€Œ3ç§’ä»¥å†…ã§ã‚²ãƒ¼ãƒ é–‹å§‹å¯èƒ½ã€ã®å®Ÿè£…å®Œäº†ã€‚
    KPIæ¸¬å®šã«ã‚ˆã‚Šå¹³å‡2.85ç§’ã‚’å®Ÿç¾ã€‚
    ç«¶åˆå„ªä½æ€§ï¼ˆãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯é–‹å§‹ï¼‰ã‚‚å®Ÿè£…æ¸ˆã¿ã€‚
```

**æ³¨æ„**: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ `done` ã«ã™ã‚‹ã®ã¯ `/cc-xp:review accept` ã®ã¿ã§ã™ã€‚

## Phase 4: E2Eï¼ˆçµ±åˆãƒ†ã‚¹ãƒˆï¼‰â€»Webã‚¢ãƒ—ãƒªã®å ´åˆã®ã¿

### E2Eãƒ†ã‚¹ãƒˆã®å®Ÿæ–½

**Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¤œå‡ºæ™‚ã®ã¿å®Ÿè¡Œ**ã€‚ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®å—ã‘å…¥ã‚Œæ¡ä»¶ã‚’ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œã«å¤‰æ›ã—ã¾ã™ã€‚

#### MCP Playwrightåˆ©ç”¨æ™‚

å—ã‘å…¥ã‚Œæ¡ä»¶ã‚’åŸºã«è‡ªå‹•çš„ã«E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼š

```typescript
// ä¾‹ï¼šãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ  ãƒ†ã‚¹ãƒˆ
await mcp__playwright__browser_navigate("http://localhost:3000")
await mcp__playwright__browser_snapshot() // åˆæœŸçŠ¶æ…‹ã®è¨˜éŒ²
await mcp__playwright__browser_type("Email input field", "ref123", "test@example.com")
await mcp__playwright__browser_type("Password input field", "ref456", "password123")
await mcp__playwright__browser_click("Login button", "ref789")
await mcp__playwright__browser_wait_for("text", "Welcome")
await mcp__playwright__browser_snapshot() // ãƒ­ã‚°ã‚¤ãƒ³å¾ŒçŠ¶æ…‹ã®è¨˜éŒ²
```

#### é€šå¸¸Playwrightåˆ©ç”¨æ™‚

```bash
# E2Eãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç”Ÿæˆï¼ˆtests/e2e/ ã¾ãŸã¯ e2e/ï¼‰
npx playwright test --headed
```

#### E2Eéå¯¾å¿œç’°å¢ƒ

æ‰‹å‹•ãƒ†ã‚¹ãƒˆæ‰‹é †ã‚’ç”Ÿæˆã—ã€ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜éŒ²ï¼š

```javascript
/*
E2Eæ‰‹å‹•ãƒ†ã‚¹ãƒˆæ‰‹é †:
1. http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã«test@example.com, password123ã‚’å…¥åŠ›
3. ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
4. "Welcome"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
*/
```

#### ç¢ºèªã¨ã‚³ãƒŸãƒƒãƒˆ

E2Eãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸã‚‰ï¼š

```bash
git add [E2Eãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«]
git commit -m "test: ğŸŒ [ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¿ã‚¤ãƒˆãƒ«]ã®E2Eãƒ†ã‚¹ãƒˆã‚’è¿½åŠ "
```

### æœ€çµ‚ã‚³ãƒŸãƒƒãƒˆ
```bash
git add docs/cc-xp/backlog.yaml docs/cc-xp/metrics.json
git commit -m "chore: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ [ID] ã‚’ testing ã«æ›´æ–°"
```

## å®Œäº†ã‚µãƒãƒªãƒ¼

TDDã‚µã‚¤ã‚¯ãƒ«å®Œäº†å¾Œã€**å¿…ãšä»¥ä¸‹ã‚’è¡¨ç¤º**ã—ã¦ãã ã•ã„ï¼š

```
ğŸ“Š TDD+E2Eã‚µã‚¤ã‚¯ãƒ«å®Œäº†
====================
ã‚¹ãƒˆãƒ¼ãƒªãƒ¼: [ã‚¿ã‚¤ãƒˆãƒ«]
ãƒ–ãƒ©ãƒ³ãƒ: story-[ID]
ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: testing âœ…

å…¨ä½“é€²æ—:
- å®Œäº†ã‚¹ãƒˆãƒ¼ãƒªãƒ¼: [X]/[ç·æ•°]
- ç¾åœ¨ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“: [çµŒéæ™‚é–“]
- ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«: [X]å›ç›®ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰

å®Ÿæ–½ãƒ•ã‚§ãƒ¼ã‚º:
âœ… Red   - ãƒ†ã‚¹ãƒˆä½œæˆï¼ˆå¤±æ•—ç¢ºèªï¼‰
âœ… Green - æœ€å°å®Ÿè£…ï¼ˆãƒ†ã‚¹ãƒˆæˆåŠŸï¼‰
âœ… Refactor - ã‚³ãƒ¼ãƒ‰æ”¹å–„ï¼ˆãƒ†ã‚¹ãƒˆç¶­æŒï¼‰
[Webã‚¢ãƒ—ãƒªã®å ´åˆã®ã¿è¡¨ç¤º]
âœ… E2E   - çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è¦–ç‚¹ï¼‰

ä½¿ç”¨ãƒ„ãƒ¼ãƒ«: 
- ãƒ¦ãƒ‹ãƒƒãƒˆ: [æ¤œå‡ºã•ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«]
- E2E: [MCP Playwright / Playwright / æ‰‹å‹•ãƒ†ã‚¹ãƒˆ]
```

### é‡è¦ï¼šæ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å¿…ãšè¡¨ç¤º

ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«ã®å›æ•°ã«é–¢ã‚ã‚‰ãšã€ä»¥ä¸‹ã‚’**å¸¸ã«æœ€å¾Œã«è¡¨ç¤º**ï¼š

```
ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
================
å‹•ä½œç¢ºèªã¨ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½:
â†’ /cc-xp:review

ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ä»¥ä¸‹ã‚’é¸æŠã§ãã¾ã™:
â€¢ accept - å—ã‘å…¥ã‚Œæ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹
â€¢ reject "ç†ç”±" - ä¿®æ­£ãŒå¿…è¦
â€¢ skip - åˆ¤å®šã‚’ä¿ç•™
```

ç‰¹ã«è¤‡æ•°å›ã®ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«æ™‚ã¯ä»¥ä¸‹ã‚‚è¿½åŠ ï¼š

```
ğŸ“Š é–‹ç™ºçŠ¶æ³
-----------
ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é–‹å§‹ã‹ã‚‰: [çµŒéæ™‚é–“]
ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«: [X]å›ç›®
å‰å›ã®å•é¡Œ: [ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‹ã‚‰è¦ç´„]

ğŸ’¡ ãƒ’ãƒ³ãƒˆ
---------
â€¢ å‰å›ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯: docs/cc-xp/stories/[ID]-feedback.md
â€¢ ä¿®æ­£å†…å®¹ã‚’ã—ã£ã‹ã‚Šç¢ºèªã—ã¦ã‹ã‚‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¸
â€¢ è©°ã¾ã£ãŸã‚‰åˆ¥ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã«åˆ‡ã‚Šæ›¿ãˆã‚‚æ¤œè¨
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ä»¥ä¸‹ã®å ´åˆã®å¯¾å‡¦ã‚’æ¡ˆå†…ã—ã¦ãã ã•ã„ï¼š

**ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ**
- ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã‚’æç¤º
- ä»£æ›¿ãƒ„ãƒ¼ãƒ«ã‚’ææ¡ˆ

**ãƒ†ã‚¹ãƒˆãŒæœ€åˆã‹ã‚‰æˆåŠŸã™ã‚‹å ´åˆ**
- Redãƒ•ã‚§ãƒ¼ã‚ºã®ã‚„ã‚Šç›´ã—ã‚’æŒ‡ç¤º
- ã‚ˆã‚Šå³å¯†ãªãƒ†ã‚¹ãƒˆã®ä½œæˆã‚’ææ¡ˆ

**ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã«ãƒ†ã‚¹ãƒˆãŒå¤±æ•—**
- å¤‰æ›´ã‚’ç¢ºèª
- git diffã§å·®åˆ†ã‚’è¡¨ç¤º
- å‰ã®ã‚³ãƒŸãƒƒãƒˆã«æˆ»ã‚‹æ–¹æ³•ã‚’æ¡ˆå†…

## ãƒ†ã‚¹ãƒˆé«˜é€ŸåŒ–ã®ã‚³ãƒ„

é–‹ç™ºåŠ¹ç‡ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®é«˜é€ŸåŒ–æ‰‹æ³•ã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ï¼š

### æ¨å¥¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³

**JavaScript/TypeScript**
- `bun test --watch` - ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã«è‡ªå‹•å†å®Ÿè¡Œ
- `npm test -- --watch` - watchãƒ¢ãƒ¼ãƒ‰ã§ç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆ
- `vitest --run --reporter=verbose` - è©³ç´°å‡ºåŠ›ã§å•é¡Œã‚’ç´ æ—©ãç‰¹å®š

**Python**
- `pytest --maxfail=1` - æœ€åˆã®å¤±æ•—ã§åœæ­¢
- `pytest -k test_name` - ç‰¹å®šãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
- `pytest --tb=short` - ç°¡æ½”ãªãƒˆãƒ¬ãƒ¼ã‚¹ãƒãƒƒã‚¯
- `pytest-watch` - ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼ˆè¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰

**Rust**
- `cargo watch -x test` - ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã«è‡ªå‹•ãƒ†ã‚¹ãƒˆ
- `cargo test --nocapture` - å‡ºåŠ›ã‚’å³åº§ã«è¡¨ç¤º

**Go**
- `go test -failfast` - æœ€åˆã®å¤±æ•—ã§åœæ­¢
- `gow test ./...` - ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ„ãƒ¼ãƒ«ï¼ˆè¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰

### é«˜é€ŸåŒ–ã®åŸå‰‡
- **éƒ¨åˆ†å®Ÿè¡Œ**: é–¢é€£ãƒ†ã‚¹ãƒˆã®ã¿ã‚’å®Ÿè¡Œã—ã¦æ™‚é–“çŸ­ç¸®
- **æ—©æœŸå¤±æ•—**: æœ€åˆã®ã‚¨ãƒ©ãƒ¼ã§åœæ­¢ã—ã¦ä¿®æ­£ã‚µã‚¤ã‚¯ãƒ«ã‚’é«˜é€ŸåŒ–
- **è‡ªå‹•å†å®Ÿè¡Œ**: ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜æ™‚ã«è‡ªå‹•ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **ä¸¦åˆ—å®Ÿè¡Œ**: å¯èƒ½ãªé™ã‚Šä¸¦åˆ—ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

## æ³¨æ„äº‹é …

- å„ãƒ•ã‚§ãƒ¼ã‚ºã¯æ˜ç¢ºã«åˆ†é›¢ï¼ˆæ··ãœãªã„ï¼‰
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®çµµæ–‡å­—ã‚’çµ±ä¸€ï¼ˆğŸ”´âœ…â™»ï¸ï¼‰
- ãƒ†ã‚¹ãƒˆã®å¤±æ•—ãƒ»æˆåŠŸã‚’å¿…ãšç¢ºèªã—ã¦ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆ
